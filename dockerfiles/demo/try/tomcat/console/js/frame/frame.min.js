function include(obj){obj.find("include").each(function(){var src=$(this).attr("src");$(this).load(src,function(){include($(this))})});obj.find("[include]").each(function(){var src=$(this).attr("include");$(this).load(src,function(){include($(this))})})}var util={getBasePath:function(){var path=$("basepath").attr("href");return(path?path:util.baseURL())},baseURL:function(){var x=window.location.href.split("/");return x[0]+"//"+x[2]+"/"+x[3]+"/"},navigate:function(_url){var url=util.getBasePath()+_url;var menuId=authority.getMenuId();if(menuId!=null){if(url.indexOf("?")>0){url+="&menuId="+menuId}else{url+="?menuId="+menuId}}window.location.href=url},authURL:function(_url){var url=util.getBasePath()+"/"+_url;var menuId=authority.getMenuId();if(menuId!=null){if(url.indexOf("?")>0){url+="&menuId="+menuId}else{url+="?menuId="+menuId}}return url},processJSONError:function(text,info,ex){function getMessage(txt){var istart=txt.indexOf("{");var iend=txt.indexOf("}")+1;var json=text;if(istart>-1&&iend>istart){json=txt.substring(istart,iend).replace("\n","")}return $.parseJSON(json)}if($("#error").length==0){$("body").append("<div id='error' style='display:none'></div>")}$("#error").html(text);text=$("#error h1").text();var msg=text;try{msg=getMessage(text)}catch(e){msg=text}$("#error").html("");if(msg.message){alert(msg.message)}else{alert(msg)}},processHtmlError:function(text){if($("#error").length==0){$("body").append("<div id='error' style='display:none'></div>")}$("#error").html(text);return $("#error h1").text()},processRequestComplete:function(request,status,url,callback,errorcall){var text=request.responseText;var err_flag=false;if(request.status=="200"){var data=request.responseJSON;if(data==null){try{data=eval("("+text+")")}catch(e){data=null}}if(data!=null&&data.rs_code!=null&&data.rs_code!="0"){err_flag=true;if(data.rs_code=="-9"){alert(data.message);util.navigate("/login.jsp?error="+encodeURIComponent(data.message));return}}data=data?data:text;if(callback){callback.call(this,data,status);return}else{return data}}else{if(status=="error"){if(request.status=="404"){alert("向服务器请求的URL["+url+"]不存在!")}else{alert(util.processHtmlError(text))}return false}else{err_flag=true}}if(err_flag){if(request.status=="404"){alert("向服务器请求的URL["+url+"]不存在!")}else{if(text.rs_code&&text.message){alert(text.message)}else{util.processJSONError.call(this,text,status)}}if(errorcall){errorcall.call(this,text,status)}else{if(callback){callback.call(this,text,status)}}}},getServerData:function(url,param,callback,errorcall,sync){var _param={};if(param){_param=param}_param.menuId=authority.getMenuId();var _url=url.indexOf("/")==0?url:"/"+url;var _async=true;if(sync){_async=false}$.ajax({type:"POST",url:util.getBasePath()+_url,dataType:"json",data:_param,async:_async,contentType:"application/x-www-form-urlencoded;charset=UTF-8",complete:function(request,status){util.processRequestComplete(request,status,_url,callback,errorcall)}})},getSyncServerData:function(url,param){var _param={};if(param){_param=param}_param.menuId=authority.getMenuId();var _url=url.indexOf("/")==0?url:"/"+url;var request=$.ajax({type:"POST",url:util.getBasePath()+_url,dataType:"json",data:_param,async:false,contentType:"application/x-www-form-urlencoded;charset=UTF-8"});return util.processRequestComplete(request,status,_url)},resolve:function(name){var className=name.substring(name.lastIndexOf("/")+1);var path=(util.getBasePath()?util.getBasePath()+"/":"")+"file.do?name=/js";if(name[0]!="/"){path+="/"}path+=name+".js";var request=$.ajax({type:"GET",url:path,dataType:"text",async:false,contentType:"application/x-www-form-urlencoded;charset=UTF-8"});var complete=function(request){var text=request.responseText;if(request.status=="200"){eval(text);var rtn=eval(className);window[className]=rtn;return rtn}else{return null}};return complete(request)},getHTML:function(url,async){if(url==undefined||url==""){return""}if(fileCache.useCache){if(fileCache.cache[url]!=null){return fileCache.cache[url]}}var path=(util.getBasePath()?util.getBasePath()+"/":"")+"file.do?name=";if(url[0]!="/"){path+="/"}path+=url;var request=$.ajax({type:"GET",url:path,dataType:"text",async:async?true:false,contentType:"application/x-www-form-urlencoded;charset=UTF-8"});var complete=function(request){var text=request.responseText;if(request.status=="200"){return text}else{return""}};return complete(request)},clearIframe:function(id){var el=document.getElementById(id),iframe=el.contentWindow;if(el){el.src="about:blank";try{iframe.document.write("");iframe.document.clear()}catch(e){}document.body.removeChild(el)}},getObjectFromArray:function(attr,value,array){if(attr==null||value==null&&array==null){return null}var len=array.length;for(var i=0;i<len;i++){var o=array[i];if(o[attr]==value){return o}}return null},cloneData:function(el){var data={};$.each(el.data(),function(key,value){data[key]=value});return data},setElementData:function(el,data){$.each(data,function(key,value){el.data(key,value)})}};var DownloadFile={getExportFileFrame:function(){var frameId="export-file-frame";
var frame=$("#"+frameId);if(frame.length>0){return frame}else{var html="<iframe id='"+frameId+"' noborder style='display:none' width=1 height=1></iframe>";$("body").append(html);return $("#"+frameId)}},downloadFile:function(url){var frame=DownloadFile.getExportFileFrame();frame.attr("src",url)}};var Browser={};Browser.Page=(function(){return{scrollTop:function(){return Math.max(document.body.scrollTop,document.documentElement.scrollTop)},scrollLeft:function(){return Math.max(document.body.scrollLeft,document.documentElement.scrollLeft)},height:function(){var _height;if(document.compatMode=="CSS1Compat"){_height=document.documentElement.scrollHeight}else{_height=document.body.scrollHeight}return _height},width:function(){var _width;if(document.compatMode=="CSS1Compat"){_width=document.documentElement.scrollWidth}else{_width=document.body.scrollWidth}return _width}}})();Browser.Window=(function(){return{outerHeight:function(){var _hei=window.outerHeight;if(typeof _hei!="number"){_hei=Browser.ViewPort.outerHeight()}return _hei},outerWidth:function(){var _wid=window.outerWidth;if(typeof _wid!="number"){_wid=Browser.ViewPort.outerWidth()}return _wid},innerHeight:function(){var _hei=window.innerHeight;if(typeof _hel!="number"){_hei=Browser.ViewPort.innerHeight()}return _hei},innerWidth:function(){var _wid=window.innerWidth;if(typeof _wid!="number"){_wid=Browser.ViewPort.innerWidth()}return _wid},height:function(){return Browser.Window.innerHeight()},width:function(){return Browser.Window.innerWidth()}}})();Browser.ViewPort=(function(){return{innerHeight:function(){var _height;if(document.compatMode=="CSS1Compat"){_height=document.documentElement.clientHeight}else{_height=document.body.clientHeight}return _height},innerWidth:function(){var _width;if(document.compatMode=="CSS1Compat"){_width=document.documentElement.clientWidth}else{_width=document.body.clientWidth}return _width},outerHeight:function(){var _height;if(document.compatMode=="CSS1Compat"){_height=document.documentElement.offsetHeight}else{_height=document.body.offsetHeight}return _height},outerWidth:function(){var _width;if(document.compatMode=="CSS1Compat"){_width=document.documentElement.offsetWidth}else{_width=document.body.offsetWidth}return _width},width:function(){return Browser.ViewPort.innerWidth()},height:function(){return Browser.ViewPort.innerHeight()}}})();function getRandomId(prev){var newId=null;do{var num=Math.round(Math.random()*1000);newId=prev+num}while($("#"+newId).length>0);return newId}var formutil={getFields:function(el){var data={};function get(o){var name=o.attr("name")?o.attr("name"):o.attr("id")?o.attr("id"):"";if(!name){return}if(o.prop("tagName").toUpperCase()=="INPUT"&&(o.attr("type").toUpperCase()=="BUTTON"||o.attr("type").toUpperCase()=="SUBMIT")){return}if(o.prop("tagName").toUpperCase()=="INPUT"&&o.attr("droptree")){data[name]=o.attr("value2")}else{if(o.val()!="undefined"){data[name]=o.val()}else{data[name]=o.text()}}}el.find("input").each(function(){get($(this))});el.find("select").each(function(){get($(this))});el.find("textarea").each(function(){get($(this))});return data},setFields:function(el,data){for(var n in data){var o=el.find("#"+n);if(o.length==0){continue}if(o.data("selectpicker")){o.selectpicker("val",data[n])}else{if(o.prop("tagName").toUpperCase()=="INPUT"&&o.attr("droptree")){o.attr("value2",data[n]);o.val(data[n])}else{o.val(data[n])}}}},reset:function(el){function clear(o){var name=o.attr("name")?o.attr("name"):o.attr("id")?o.attr("id"):"";if(!name){return}if(o.prop("tagName").toUpperCase()=="INPUT"&&(o.attr("type").toUpperCase()=="BUTTON"||o.attr("type").toUpperCase()=="SUBMIT")){return}if(o.prop("tagName").toUpperCase()=="INPUT"&&o.attr("droptree")){o.attr("value2","")}o.val("")}el.find("input").each(function(){clear($(this))});el.find("select").each(function(){clear($(this))});el.find("textarea").each(function(){clear($(this))})}};function getRandomNum(len,max){var num=0;do{num=Math.round(Math.random()*Math.pow(10,len))}while((max?(num>max):(num==0))||num==0);return num}$(document).ready(function(){include($("body"))});var fileCache={useCache:true,cache:{}};